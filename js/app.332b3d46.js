(function(t){function e(e){for(var o,a,c=e[0],s=e[1],u=e[2],f=0,d=[];f<c.length;f++)a=c[f],r[a]&&d.push(r[a][0]),r[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},r={app:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/falling-blocks/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("64a9"),r=n.n(o);r.a},"0aa3":function(t,e,n){"use strict";var o=n("df9e"),r=n.n(o);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Game")],1)},i=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"layout"},[n("Grid"),n("Score")],1),n("GameOver")],1)},c=[],s=n("cebc"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"grid",class:t.className},[n("Row",{attrs:{cells:t.firstRow}}),t._l(t.rowsWithWalls,function(e,o){return n("Row",{key:o,attrs:{cells:e,"to-remove":-1!==t.rowsToRemove.indexOf(o)}})}),n("Row",{attrs:{cells:t.lastRow}})],2)},l=[],f=n("75fc"),d=n("774e"),v=n.n(d),m=n("2f62"),h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},t._l(t.cells,function(e,o){return n("Cell",{key:o,attrs:{value:e,"to-remove":t.toRemove}})}),1)},p=[],b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cell",class:t.className,style:{"--rotation":t.rotation}})},w=[],k=n("bd86"),g={I:["  I ","  I ","  I ","  I "].join(""),O:["    "," OO "," OO ","    "].join(""),T:["    "," TTT","  T ","    "].join(""),J:["    ","J   ","JJJ ","    "].join(""),L:["    ","   L"," LLL","    "].join(""),S:["    ","  SS"," SS ","    "].join(""),Z:["    "," ZZ ","  ZZ","    "].join("")},y=" ",R="wall",O=[0,40,100,300,1200],x=500,j={width:4,height:4},_={width:12,height:22},T={left:37,up:38,right:39,down:40,space:32},G={props:["value","toRemove"],computed:{className:function(){var t;return t={},Object(k["a"])(t,"color-".concat(this.value),!0),Object(k["a"])(t,"filled",this.value!=y),Object(k["a"])(t,"to-remove",this.toRemove&&this.value!==R),t},rotation:function(){var t=Math.random()>.5?1:-1,e=30*Math.random()+60;return"".concat(t*e,"deg")}}},B=G,S=(n("97b1"),n("2877")),C=Object(S["a"])(B,b,w,!1,null,"248c4ecf",null),M=C.exports,F={props:["cells","toRemove"],components:{Cell:M}},N=F,E=(n("f044"),Object(S["a"])(N,h,p,!1,null,"06f37ab6",null)),A=E.exports,P={data:function(){return{firstRow:v()(Array(_.width+2)).map(function(){return R}),lastRow:v()(Array(_.width+2)).map(function(){return R})}},computed:Object(s["a"])({},Object(m["c"])(["grid","rowsToRemove","isRunning"]),{rowsWithWalls:function(){return this.grid.map(function(t){return[R].concat(Object(f["a"])(t),[R])})},className:function(){return{blur:!this.isRunning}}}),components:{Row:A}},$=P,J=(n("b644"),Object(S["a"])($,u,l,!1,null,"a4175130",null)),L=J.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"score",class:t.className},[n("div",[t._v("Score")]),n("div",[t._v(t._s(t.score))])])},V=[],Z={computed:Object(s["a"])({},Object(m["c"])(["score","isRunning"]),{className:function(){return{blur:!this.isRunning}}})},q=Z,W=(n("0aa3"),Object(S["a"])(q,I,V,!1,null,"4d17b5a3",null)),Y=W.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isRunning?t._e():n("div",{staticClass:"game-over"},[t.isFirstGame?t._e():n("div",{staticClass:"red title"},[n("b",[t._v("Game Over")])]),t._m(0)])},D=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v("\n    Press\n    "),n("b",{staticClass:"blue"},[t._v("[Space]")]),t._v(" to start a new game.\n  ")])}],z={computed:Object(m["c"])(["isRunning","isFirstGame"])},H=z,K=(n("ae53"),Object(S["a"])(H,X,D,!1,null,"1b9d19c0",null)),Q=K.exports,U={data:function(){return{lastTimestamp:null,tickCounter:0}},methods:Object(s["a"])({},Object(m["b"])(["fallBlock","moveBlock","rotateBlock","startNewGame"]),{keydown:function(t){if(this.isRunning)switch(t.keyCode){case T.up:return void this.rotateBlock();case T.left:return void this.moveBlock({xOffset:-1});case T.right:return void this.moveBlock({xOffset:1});case T.down:return void this.moveBlock({yOffset:1});default:break}else t.keyCode===T.space&&this.startNewGame()},tick:function(t){if(this.isRunning){if(!this.lastTimestamp)return this.lastTimestamp=t,void requestAnimationFrame(this.tick);var e=t-this.lastTimestamp;this.lastTimestamp=t;var n=this.tickCounter+=e;n>this.speed?(this.fallBlock(),this.tickCounter=0):this.tickCounter=n,requestAnimationFrame(this.tick)}else requestAnimationFrame(this.tick)}}),computed:Object(m["c"])(["grid","rowsToRemove","speed","isRunning"]),components:{Grid:L,Score:Y,GameOver:Q},created:function(){window.addEventListener("keydown",this.keydown),requestAnimationFrame(this.tick)},beforeDestroy:function(){window.removeEventListener("keydown",this.keydown)}},tt=U,et=(n("58c7"),Object(S["a"])(tt,a,c,!1,null,"5f3207fc",null)),nt=et.exports,ot={name:"app",components:{Game:nt}},rt=ot,it=(n("034f"),Object(S["a"])(rt,r,i,!1,null,null,null)),at=it.exports,ct=(n("ac6a"),n("7f7f"),n("a4bb")),st=n.n(ct),ut={block:{name:st()(g)[Math.floor(7*Math.random())],x:_.width/2-j.width/2,y:-1,rotation:0},grid:v()(Array(_.height)).map(function(){return v()(Array(_.width)).map(function(){return y})}),rowsToRemove:[],isFirstGame:!0,isGameRunning:!1,score:0,speed:x},lt=function(t){var e=t.x,n=t.y,o=t.rotation;switch(o){case 1:return 12-4*e+n;case 2:return 15-4*n-e;case 3:return 3+4*e-n;case 0:default:return 4*n+e}},ft={x:function(t){return t.block.x},y:function(t){return t.block.y},rotation:function(t){return t.block.rotation},isRunning:function(t){return t.isGameRunning},isFirstGame:function(t){return t.isFirstGame},score:function(t){return t.score},speed:function(t){return t.speed},grid:function(t,e){for(var n=t.grid.slice().map(function(t){return t.slice()}),o=e.block,r=t.block,i=r.y,a=r.x,c=0;c<j.height;c++)for(var s=0;s<j.width;s++)if(s+a<_.width&&c+i<_.height&&s+a>=0&&c+i>=0){if(o[c][s]===y)continue;n[c+i][s+a]=o[c][s]}return n},block:function(t){for(var e=[],n=t.block,o=n.name,r=n.rotation,i=0;i<j.height;i++){for(var a=[],c=0;c<j.width;c++){var s=lt({x:c,y:i,rotation:r});a.push(g[o][s])}e.push(a)}return e},isValidMove:function(t,e){var n=t.block.name;return function(e){for(var o=e.x,r=void 0===o?0:o,i=e.y,a=void 0===i?0:i,c=e.rotation,s=void 0===c?0:c,u=0;u<4;u++)for(var l=0;l<4;l++){var f=lt({y:u,x:l,rotation:s});if(g[n][f]!==y){if(l+r<0)return!1;if(l+r>_.width-1)return!1;if(u+a>_.height-1)return!1;if(t.grid[u+a][l+r]!==y)return!1}}return!0}},shouldRemoveRow:function(t){return function(e){if(e>=_.height)return!1;for(var n=0;n<_.width;n++)if(t.grid[e][n]===y)return!1;return!0}},rowsToRemove:function(t){return t.rowsToRemove},firstFilledCellYPosition:function(t){for(var e=t.block,n=e.name,o=e.rotation,r=0;r<j.height;r++)for(var i=0;i<j.width;i++){var a=lt({y:r,x:i,rotation:o});if(g[n][a]!==y)return r+t.block.y}return 0}},dt={fallBlock:function(t){var e=t.dispatch;e("moveBlock",{yOffset:1})},moveBlock:function(t,e){var n=t.commit,o=t.getters,r=e.xOffset,i=void 0===r?0:r,a=e.yOffset,c=void 0===a?0:a,s=o.x,u=o.y,l=o.rotation,f=o.block,d=o.rowsToRemove;if(n("removeFullRows"),n("increaseScore",O[d.length]),0!==i&&o.isValidMove({x:s+i,y:u,rotation:l})?n("setBlockX",s+i):o.isValidMove({x:s,y:u+c,rotation:l})&&n("setBlockY",u+c),!o.isValidMove({x:s,y:u+c+1,rotation:l})){if(n("copyBlockToGrid",{x:s,y:u+c,block:f}),o.firstFilledCellYPosition<=0)return void n("gameOver");n("createNewBlock"),n("decreaseSpeed");for(var v=0;v<j.height;v++)o.shouldRemoveRow(u+v+1)&&n("markRowToRemove",u+v+1)}},rotateBlock:function(t){var e=t.commit,n=t.getters,o=n.x,r=n.y,i=n.rotation,a=i+1;a>3&&(a=0),n.isValidMove({x:o,y:r,rotation:a})&&e("setBlockRotation",a)},startNewGame:function(t){var e=t.commit;e("createNewGrid"),e("createNewBlock")}},vt={setBlockX:function(t,e){t.block.x=e},setBlockY:function(t,e){t.block.y=e},setBlockRotation:function(t,e){t.block.rotation=e},createNewBlock:function(t){t.block.x=_.width/2-j.width/2,t.block.y=-1,t.block.rotation=0,t.block.name=st()(g)[Math.floor(7*Math.random())]},copyBlockToGrid:function(t,e){for(var n=e.block,o=e.x,r=e.y,i=t.grid.slice().map(function(t){return t.slice()}),a=0;a<j.height;a++)for(var c=0;c<j.width;c++)n[a][c]!==y&&(i[a+r][c+o]=n[a][c]);t.grid=i},markRowToRemove:function(t,e){t.rowsToRemove=[].concat(Object(f["a"])(t.rowsToRemove),[e])},removeFullRows:function(t){t.rowsToRemove.forEach(function(e){for(var n=e;n>1;n--)t.grid[n]=t.grid[n-1]}),t.rowsToRemove=[]},decreaseSpeed:function(t){t.speed>10&&(t.speed*=.97)},gameOver:function(t){t.isGameRunning=!1,t.isFirstGame=!1},increaseScore:function(t,e){t.score+=e},createNewGrid:function(t){t.speed=x,t.score=0,t.grid=v()(Array(_.height)).map(function(){return v()(Array(_.width)).map(function(){return y})}),t.isGameRunning=!0}},mt={state:ut,getters:ft,actions:dt,mutations:vt};o["a"].use(m["a"]);var ht=new m["a"].Store({modules:{game:mt}});o["a"].config.productionTip=!1,new o["a"]({store:ht,render:function(t){return t(at)}}).$mount("#app")},"58c7":function(t,e,n){"use strict";var o=n("9e9c"),r=n.n(o);r.a},"5a5a":function(t,e,n){},"64a9":function(t,e,n){},"97b1":function(t,e,n){"use strict";var o=n("d171"),r=n.n(o);r.a},"9e9c":function(t,e,n){},a79f:function(t,e,n){},ae53:function(t,e,n){"use strict";var o=n("5a5a"),r=n.n(o);r.a},b644:function(t,e,n){"use strict";var o=n("d0e1"),r=n.n(o);r.a},d0e1:function(t,e,n){},d171:function(t,e,n){},df9e:function(t,e,n){},f044:function(t,e,n){"use strict";var o=n("a79f"),r=n.n(o);r.a}});
//# sourceMappingURL=app.332b3d46.js.map